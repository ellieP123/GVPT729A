% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrartcl}

\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else  
    % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
% Make \paragraph and \subparagraph free-standing
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother

\KOMAoption{captions}{tableheading}
\makeatletter
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\makeatletter
\@ifpackageloaded{tcolorbox}{}{\usepackage[skins,breakable]{tcolorbox}}
\makeatother
\makeatletter
\@ifundefined{shadecolor}{\definecolor{shadecolor}{rgb}{.97, .97, .97}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\makeatother
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Lasso\_OLS\_comparison},
  pdfauthor={Birnir},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}

\title{Lasso\_OLS\_comparison}
\author{Birnir}
\date{}

\begin{document}
\maketitle
\ifdefined\Shaded\renewenvironment{Shaded}{\begin{tcolorbox}[sharp corners, boxrule=0pt, interior hidden, breakable, enhanced, frame hidden, borderline west={3pt}{0pt}{shadecolor}]}{\end{tcolorbox}}\fi

\hypertarget{step-1-simulate-the-data}{%
\subsubsection{Step 1: Simulate the
Data}\label{step-1-simulate-the-data}}

We will generate a simple dataset with two predictor variables
(\texttt{x1}, \texttt{x2}) and a response variable (\texttt{y}), which
will have a known linear relationship.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Set the seed for reproducibility}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}

\CommentTok{\# Simulate data}
\NormalTok{n }\OtherTok{\textless{}{-}} \DecValTok{100}  \CommentTok{\# number of observations}
\NormalTok{x1 }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(n)  }\CommentTok{\# predictor 1}
\NormalTok{x2 }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(n)  }\CommentTok{\# predictor 2}
\NormalTok{x3 }\OtherTok{=} \FunctionTok{rnorm}\NormalTok{(n)}

\CommentTok{\# Response variable with some noise}
\NormalTok{y }\OtherTok{\textless{}{-}} \DecValTok{3} \SpecialCharTok{+} \FloatTok{0.5} \SpecialCharTok{*}\NormalTok{ x1 }\SpecialCharTok{+} \DecValTok{2} \SpecialCharTok{*}\NormalTok{ x2 }\SpecialCharTok{+} \FunctionTok{rnorm}\NormalTok{(n)}

\CommentTok{\# Combine into a data frame}
\NormalTok{dat }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{x1 =}\NormalTok{ x1, }\AttributeTok{x2 =}\NormalTok{ x2, }\AttributeTok{x3 =}\NormalTok{ x3, }\AttributeTok{y =}\NormalTok{ y)}

\CommentTok{\# View the first few rows of the data}
\FunctionTok{head}\NormalTok{(dat)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
           x1          x2         x3         y
1 -0.56047565 -0.71040656  2.1988103 0.5837069
2 -0.23017749  0.25688371  1.3124130 2.6459897
3  1.55870831 -0.24669188 -0.2651451 2.3474317
4  0.07050839 -0.34754260  0.5431941 1.2876557
5  0.12928774 -0.95161857 -0.4143399 0.7242472
6  1.71506499 -0.04502772 -0.4762469 4.0986562
\end{verbatim}

\hypertarget{step-2-split-the-data-into-training-and-test-sets}{%
\subsubsection{Step 2: Split the Data into Training and Test
Sets}\label{step-2-split-the-data-into-training-and-test-sets}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load the required package}
\FunctionTok{library}\NormalTok{(caret)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Loading required package: ggplot2
\end{verbatim}

\begin{verbatim}
Loading required package: lattice
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Split the data: 70\% for training, 30\% for testing}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)}
\NormalTok{train\_index }\OtherTok{\textless{}{-}} \FunctionTok{createDataPartition}\NormalTok{(dat}\SpecialCharTok{$}\NormalTok{y, }\AttributeTok{p =} \FloatTok{0.7}\NormalTok{, }\AttributeTok{list =} \ConstantTok{FALSE}\NormalTok{)}
\NormalTok{train\_data }\OtherTok{\textless{}{-}}\NormalTok{ dat[train\_index, ]}
\NormalTok{test\_data }\OtherTok{\textless{}{-}}\NormalTok{ dat[}\SpecialCharTok{{-}}\NormalTok{train\_index, ]}
\end{Highlighting}
\end{Shaded}

\hypertarget{step-3-fit-the-ols-ordinary-least-squares-model}{%
\subsubsection{Step 3: Fit the OLS (Ordinary Least Squares)
Model}\label{step-3-fit-the-ols-ordinary-least-squares-model}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Fit an OLS model}
\NormalTok{ols\_model }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(y }\SpecialCharTok{\textasciitilde{}}\NormalTok{ x1 }\SpecialCharTok{+}\NormalTok{ x2 }\SpecialCharTok{+}\NormalTok{ x3, }\AttributeTok{data =}\NormalTok{ train\_data)}

\CommentTok{\# View the model summary to see the coefficients}
\FunctionTok{summary}\NormalTok{(ols\_model)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}

Call:
lm(formula = y ~ x1 + x2 + x3, data = train_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.05946 -0.67524  0.08166  0.63739  1.96975 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  2.92877    0.11985  24.436  < 2e-16 ***
x1           0.40712    0.13425   3.033  0.00343 ** 
x2           2.14785    0.12826  16.746  < 2e-16 ***
x3           0.01886    0.13549   0.139  0.88973    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.002 on 68 degrees of freedom
Multiple R-squared:  0.8088,    Adjusted R-squared:  0.8003 
F-statistic: 95.86 on 3 and 68 DF,  p-value: < 2.2e-16
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Predict on the test data}
\NormalTok{ols\_predictions }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(ols\_model, }\AttributeTok{newdata =}\NormalTok{ test\_data)}
\end{Highlighting}
\end{Shaded}

\hypertarget{step-4-fit-the-lasso-regression-model-using-glmnet.}{%
\subsubsection{\texorpdfstring{Step 4: Fit the Lasso Regression Model
using
\texttt{glmnet}.}{Step 4: Fit the Lasso Regression Model using glmnet.}}\label{step-4-fit-the-lasso-regression-model-using-glmnet.}}

Use cross-validation to find the optimal value of \texttt{lambda}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load the glmnet package}
\FunctionTok{library}\NormalTok{(glmnet)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Loading required package: Matrix
\end{verbatim}

\begin{verbatim}
Loaded glmnet 4.1-8
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Prepare the predictors and response variable}
\NormalTok{X\_train }\OtherTok{\textless{}{-}} \FunctionTok{as.matrix}\NormalTok{(train\_data[, }\FunctionTok{c}\NormalTok{(}\StringTok{"x1"}\NormalTok{, }\StringTok{"x2"}\NormalTok{, }\StringTok{"x3"}\NormalTok{)])  }\CommentTok{\# predictors for training}
\NormalTok{y\_train }\OtherTok{\textless{}{-}}\NormalTok{ train\_data}\SpecialCharTok{$}\NormalTok{y  }\CommentTok{\# response for training}
\NormalTok{X\_test }\OtherTok{\textless{}{-}} \FunctionTok{as.matrix}\NormalTok{(test\_data[, }\FunctionTok{c}\NormalTok{(}\StringTok{"x1"}\NormalTok{, }\StringTok{"x2"}\NormalTok{, }\StringTok{"x3"}\NormalTok{)])  }\CommentTok{\# predictors for testing}

\CommentTok{\# Fit a Lasso model with cross{-}validation to find the best lambda}
\NormalTok{lasso\_cv\_model }\OtherTok{\textless{}{-}} \FunctionTok{cv.glmnet}\NormalTok{(X\_train, y\_train, }\AttributeTok{alpha =} \DecValTok{1}\NormalTok{)}
\CommentTok{\#cv.glmnet(): This function fits a generalized linear model using Lasso regularization and performs cross{-}validation to select the best lambda.}

\CommentTok{\#alpha = 1: This sets the model to use Lasso regression. In the glmnet function, alpha determines the type of regularization:}
\CommentTok{\#alpha = 1: Lasso (L1 regularization).}
\CommentTok{\#alpha = 0: Ridge regression (L2 regularization).}
\CommentTok{\#alpha between 0 and 1: Elastic Net (a mix of both Lasso and Ridge).}


\CommentTok{\# Find the best lambda}
\NormalTok{best\_lambda }\OtherTok{\textless{}{-}}\NormalTok{ lasso\_cv\_model}\SpecialCharTok{$}\NormalTok{lambda.min}

\CommentTok{\# Print the best lambda}
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste}\NormalTok{(}\StringTok{"Best Lambda (Lasso):"}\NormalTok{, best\_lambda))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[1] "Best Lambda (Lasso): 0.0395780954412222"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Fit the final Lasso model using the best lambda}
\NormalTok{lasso\_model }\OtherTok{\textless{}{-}} \FunctionTok{glmnet}\NormalTok{(X\_train, y\_train, }\AttributeTok{alpha =} \DecValTok{1}\NormalTok{, }\AttributeTok{lambda =}\NormalTok{ .}\DecValTok{09}\NormalTok{)}
\CommentTok{\#Tuning of lambda {-} making the penalty bigger (more bias less variance)}
\CommentTok{\#lasso\_model \textless{}{-} glmnet(X\_train, y\_train, alpha = 1, lambda = .9)}


\CommentTok{\# Predict on the test data using the Lasso model}
\NormalTok{lasso\_predictions }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(lasso\_model, }\AttributeTok{newx =}\NormalTok{ X\_test)}
\end{Highlighting}
\end{Shaded}

\hypertarget{step-5-calculate-comparison-metrics}{%
\subsubsection{Step 5: Calculate Comparison
Metrics}\label{step-5-calculate-comparison-metrics}}

There are several metrics to evaluate model performance

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  MSE (\textbf{Mean Squared Error)}
\end{enumerate}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\item
  \textbf{RMSE (Root Mean Squared Error)}: The square root of MSE,
  making it more interpretable in the same units as the dependent
  variable. Lower RMSE indicates better fit.
\item
  \textbf{MAE (Mean Absolute Error)}: Measures the average absolute
  difference between predicted and actual values. Unlike MSE, it doesn't
  square the errors, so it's less sensitive to large (outlier) errors.
  Lower MSE indicates better fit.
\item
  \textbf{R-squared (RÂ²)}: Measures how well the model explains the
  variability of the response variable. Higher values indicate that the
  model explains more variance in the data.
\end{enumerate}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load required libraries}
\FunctionTok{library}\NormalTok{(glmnet)}
\FunctionTok{library}\NormalTok{(caret)}

\CommentTok{\# Function to calculate alternative metrics}
\NormalTok{calculate\_metrics }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(actual, predicted) \{}
\NormalTok{  mse }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{((actual }\SpecialCharTok{{-}}\NormalTok{ predicted)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{  rmse }\OtherTok{\textless{}{-}} \FunctionTok{sqrt}\NormalTok{(mse)}
\NormalTok{  mae }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(}\FunctionTok{abs}\NormalTok{(actual }\SpecialCharTok{{-}}\NormalTok{ predicted))}
\NormalTok{  r\_squared }\OtherTok{\textless{}{-}} \FunctionTok{cor}\NormalTok{(actual, predicted)}\SpecialCharTok{\^{}}\DecValTok{2}
  \FunctionTok{return}\NormalTok{(}\FunctionTok{data.frame}\NormalTok{(}\AttributeTok{MSE =}\NormalTok{ mse, }\AttributeTok{RMSE =}\NormalTok{ rmse, }\AttributeTok{MAE =}\NormalTok{ mae, }\AttributeTok{R2 =}\NormalTok{ r\_squared))}
\NormalTok{\}}

\CommentTok{\# OLS Model Metrics}
\NormalTok{ols\_predictions }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(ols\_model, }\AttributeTok{newdata =}\NormalTok{ test\_data)}
\NormalTok{ols\_metrics }\OtherTok{\textless{}{-}} \FunctionTok{calculate\_metrics}\NormalTok{(test\_data}\SpecialCharTok{$}\NormalTok{y, ols\_predictions)}

\CommentTok{\# Lasso Model Metrics}
\NormalTok{lasso\_predictions }\OtherTok{\textless{}{-}} \FunctionTok{as.vector}\NormalTok{(}\FunctionTok{predict}\NormalTok{(lasso\_model, }\AttributeTok{newx =}\NormalTok{ X\_test))}
\NormalTok{lasso\_metrics }\OtherTok{\textless{}{-}} \FunctionTok{calculate\_metrics}\NormalTok{(test\_data}\SpecialCharTok{$}\NormalTok{y, lasso\_predictions)}

\CommentTok{\# Combine metrics into a data frame}
\NormalTok{metrics\_comparison }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(}
  \FunctionTok{cbind}\NormalTok{(}\AttributeTok{Model =} \StringTok{"OLS"}\NormalTok{, ols\_metrics),}
  \FunctionTok{cbind}\NormalTok{(}\AttributeTok{Model =} \StringTok{"Lasso"}\NormalTok{, lasso\_metrics)}
\NormalTok{)}

\CommentTok{\# Print the comparison of metrics}
\FunctionTok{print}\NormalTok{(metrics\_comparison)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
  Model      MSE     RMSE       MAE        R2
1   OLS 1.426834 1.194501 0.9704301 0.7496898
2 Lasso 1.402701 1.184357 0.9406053 0.7451500
\end{verbatim}

\hypertarget{step-6-plot-the-metrics}{%
\subsubsection{Step 6: Plot the Metrics}\label{step-6-plot-the-metrics}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Load ggplot2 for plotting}
\FunctionTok{library}\NormalTok{(ggplot2)}

\CommentTok{\# Convert the data to a long format for easier plotting}
\NormalTok{metrics\_long }\OtherTok{\textless{}{-}}\NormalTok{ reshape2}\SpecialCharTok{::}\FunctionTok{melt}\NormalTok{(metrics\_comparison, }\AttributeTok{id.vars =} \StringTok{"Model"}\NormalTok{)}

\CommentTok{\# Plot the comparison of metrics}
\FunctionTok{ggplot}\NormalTok{(metrics\_long, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ variable, }\AttributeTok{y =}\NormalTok{ value, }\AttributeTok{fill =}\NormalTok{ Model)) }\SpecialCharTok{+}
  \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{stat =} \StringTok{"identity"}\NormalTok{, }\AttributeTok{position =} \StringTok{"dodge"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{title =} \StringTok{"Model Performance Metrics: OLS vs Lasso"}\NormalTok{,}
       \AttributeTok{x =} \StringTok{"Metric"}\NormalTok{,}
       \AttributeTok{y =} \StringTok{"Value"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{theme\_minimal}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{scale\_fill\_manual}\NormalTok{(}\AttributeTok{values =} \FunctionTok{c}\NormalTok{(}\StringTok{"OLS"} \OtherTok{=} \StringTok{"blue"}\NormalTok{, }\StringTok{"Lasso"} \OtherTok{=} \StringTok{"red"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{figure}[H]

{\centering \includegraphics{Hyeri{]}-LassoVsOLS_forclass_files/figure-pdf/unnamed-chunk-6-1.pdf}

}

\end{figure}

\begin{itemize}
\tightlist
\item
\end{itemize}



\end{document}
